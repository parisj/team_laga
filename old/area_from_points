import json
import numpy as np
import pandas as pd
import geopandas as gpd

import matplotlib.pyplot as plt

from shapely.geometry import Polygon
from shapely.geometry import LineString

zonen_30 = pd.read_csv("/Users/leartsej/Desktop/team_laga/data/tempo-30-zonen.csv", sep=";")
begegnungszonen = pd.read_csv("/Users/leartsej/Desktop/team_laga/data/begegnungszonen.csv", sep=";")
gemeindestrassen = pd.read_csv("/Users/leartsej/Desktop/team_laga/data/gemeindestrassenplan.csv", sep=";")

r = 6371000

begegnungszonen_js = json.loads(gemeindestrassen['Geo Shape'][100])
data = np.array(begegnungszonen_js['coordinates'][0])
# data *= 1e4

x = r * np.sin(np.radians(data[:, 0])) * np.cos(np.radians(data[:, 1]))
y = r * np.sin(np.radians(data[:, 0])) * np.sin(np.radians(data[:, 1]))
z = r * np.cos(np.radians(data[:, 0]))

data = np.array([xyz for xyz in zip(x, y, z)])
polygon = Polygon(data)

print(polygon.area)

# p = gpd.GeoSeries(polygon)
# p.plot()
# plt.show()

from centerline.geometry import Centerline
centerline = Centerline(polygon)

p = gpd.GeoDataFrame(centerline)
p = p.set_geometry(0)
# p.plot()
# plt.show()

# breakpoint()

s = gpd.GeoSeries(centerline)

# print(centerline)
polyline = LineString(data)
print(s.distance(polyline).max())

# fig, ax = plt.subplots()
# ax.plot(data[:, 0], data[:, 1], ls="-", marker="o")
# plt.show()